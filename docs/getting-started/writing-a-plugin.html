<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Writing a Plugin | Zephyr</title>
    <meta name="generator" content="VuePress 1.8.2">
    
    <meta name="description" content="A Java Plugin System for the 21st Century">
    
    <link rel="preload" href="/assets/css/0.styles.d14442de.css" as="style"><link rel="preload" href="/assets/js/app.735f26e0.js" as="script"><link rel="preload" href="/assets/js/2.c0ff3308.js" as="script"><link rel="preload" href="/assets/js/18.d1c8d034.js" as="script"><link rel="prefetch" href="/assets/js/10.be5e3753.js"><link rel="prefetch" href="/assets/js/11.c1e9ad96.js"><link rel="prefetch" href="/assets/js/12.b168a5b9.js"><link rel="prefetch" href="/assets/js/13.8d4cb290.js"><link rel="prefetch" href="/assets/js/14.d4371f29.js"><link rel="prefetch" href="/assets/js/15.cd28a299.js"><link rel="prefetch" href="/assets/js/16.1a6f97a2.js"><link rel="prefetch" href="/assets/js/17.6cd84bbf.js"><link rel="prefetch" href="/assets/js/19.6cc89483.js"><link rel="prefetch" href="/assets/js/20.33bad5e8.js"><link rel="prefetch" href="/assets/js/21.ec88138d.js"><link rel="prefetch" href="/assets/js/3.2942ef26.js"><link rel="prefetch" href="/assets/js/4.3caf0e69.js"><link rel="prefetch" href="/assets/js/5.b0f35a3c.js"><link rel="prefetch" href="/assets/js/6.3b13bdff.js"><link rel="prefetch" href="/assets/js/7.a30a8cfb.js"><link rel="prefetch" href="/assets/js/8.5a9c729e.js"><link rel="prefetch" href="/assets/js/9.ee18fbcb.js">
    <link rel="stylesheet" href="/assets/css/0.styles.d14442de.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/wind-duotone.svg" alt="Zephyr" class="logo"> <span class="site-name can-hide">Zephyr</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"> <a href="https://github.com/sunshower-io/zephyr" target="_blank" rel="noopener noreferrer" class="repo-link">
    Get Zephyr
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"> <a href="https://github.com/sunshower-io/zephyr" target="_blank" rel="noopener noreferrer" class="repo-link">
    Get Zephyr
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Overview</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Getting started</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/getting-started/getting-started.html" class="sidebar-link">Prerequisites</a></li><li><a href="/getting-started/writing-a-plugin.html" aria-current="page" class="active sidebar-link">Writing a Plugin</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/getting-started/writing-a-plugin.html#hello-world" class="sidebar-link">Hello World!</a></li></ul></li><li><a href="/getting-started/building-zephyr.html" class="sidebar-link">Building Zephyr</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Concepts</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Kernel</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Lifecycle</span> <!----></p> <!----></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Plugins</span> <!----></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Shell</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="writing-a-plugin"><a href="#writing-a-plugin" class="header-anchor">#</a> Writing a Plugin</h1> <p>Zephyr was designed to make plugin implementation a breeze.  Zephyr is bundled with support
for common archive formats such as WAR, JAR, and Spring Boot applications.  Let's start with a
Zephyr <code>Hello World</code>!</p> <h2 id="hello-world"><a href="#hello-world" class="header-anchor">#</a> Hello World!</h2> <h3 id="step-0-check-out-the-hello-world-tutorial-project"><a href="#step-0-check-out-the-hello-world-tutorial-project" class="header-anchor">#</a> Step 0: Check out the Hello World Tutorial Project</h3> <p>First, checkout the <a href="https://github.com/sunshower-io/zephyr-tutorials" target="_blank" rel="noopener noreferrer">zephyr-tutorials<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>
by executing <code>git clone git@github.com:sunshower-io/zephyr-tutorials &amp;&amp; git checkout hello-world</code></p> <p>You will see the following directory structure</p> <div class="language- extra-class"><pre class="language-text"><code>.
├── build.gradle
├── gradle
│   └── wrapper
│       ├── gradle-wrapper.jar
│       └── gradle-wrapper.properties
├── gradle.properties
├── gradlew
├── gradlew.bat
├── lessons
│   └── 1
│       └── hello-world
│           ├── build.gradle
│           ├── pom.xml
│           └── src
│               └── main
│                   ├── java
│                   │   └── io
│                   │       └── zephyr
│                   │           └── lessons
│                   │               └── helloworld
│                   │                   └── HelloWorldModuleActivator.java
│                   └── resources
│                       └── META-INF
│                           └── services
│                               └── io.zephyr.api.ModuleActivator
├── LICENSE
├── mvnw
├── mvnw.cmd
├── pom.xml
├── README.md
├── settings.gradle
└── settings.xml
</code></pre></div><h3 id="password"><a href="#password" class="header-anchor">#</a> Password</h3> <p>Since Github does not currently allow public (unauthenticated) access to package repositories,
use the following read-only personal access token (<code>$PAT</code>):</p> <div class="language- extra-class"><pre class="language-text"><code>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
</code></pre></div><h3 id="step-1-set-your-environment-variables-and-system-properties"><a href="#step-1-set-your-environment-variables-and-system-properties" class="header-anchor">#</a> Step 1: Set your environment variables and system properties</h3> <p>Set the environment-variable <code>ZEPHYR_REPO_PASSWORD</code> to <code>$PAT</code> (the value above)</p> <p><strong>OR</strong></p> <p>In the <code>settings.xml</code> file, replace the <code>&lt;password&gt;${ENV.ZEPHYR_REPO_PASSWORD}&lt;/password&gt;</code>
segment with <code>$PAT</code> above in the section:</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servers</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>server</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span><span class="token punctuation">&gt;</span></span>sunshower-github<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>id</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>username</span><span class="token punctuation">&gt;</span></span>packages<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>username</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>password</span><span class="token punctuation">&gt;</span></span>${ENV.ZEPHYR_REPO_PASSWORD}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>password</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>server</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servers</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h3 id="step-2-add-the-personal-access-token-to-the-gradle-properties-file"><a href="#step-2-add-the-personal-access-token-to-the-gradle-properties-file" class="header-anchor">#</a> Step 2: Add the Personal Access Token to the gradle.properties file</h3> <p>In <code>$HOME/.gradle/gradle.properties</code> set the property <code>repoAccessToken</code> to <code>$PAT</code>.  It will look like:</p> <p><em>$HOME/.gradle/gradle.properties</em></p> <div class="language-properties extra-class"><pre class="language-properties"><code><span class="token attr-name">repoAccessToken</span><span class="token punctuation">=</span><span class="token attr-value">&lt;$PAT&gt;</span>
</code></pre></div><h3 id="step-3-build-your-plugin"><a href="#step-3-build-your-plugin" class="header-anchor">#</a> Step 3: Build your plugin</h3> <p>In the <code>zephyr-tutorials</code> project, run <code>mvn clean install &amp;&amp; gradle clean build</code>.  This will
produce <code>WAR</code> file at <code>zephyr-tutorials/lessons/1/hello-world/build/libs/hello-world.war</code>.  This is
your plugin archive</p> <h3 id="download-a-zephyr-distribution"><a href="#download-a-zephyr-distribution" class="header-anchor">#</a> Download a Zephyr Distribution</h3> <p>Grab the latest <a href="https://github.com/sunshower-io/zephyr/releases" target="_blank" rel="noopener noreferrer">Zephyr distribution<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>
from <a href="https://github.com/sunshower-io/zephyr/releases" target="_blank" rel="noopener noreferrer">https://github.com/sunshower-io/zephyr/releases<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>
(either <code>zephyr-main.tar</code> or <code>zephyr-main.zip</code>)--if you're on Windows, you'll probably want the <code>zip</code>
distribution.  If you're on <code>linux</code> you'll probably want the <code>tar</code> distribution.</p> <p>Extract the distribution by either right-clicking on it and selecting <code>unzip</code> or running
<code>tar xvf zephyr-main.tar</code></p> <p>You will get this directory structure:</p> <div class="language- extra-class"><pre class="language-text"><code>.
├── zephyr-main
│   ├── bin
│   │   ├── zephyr
│   │   └── zephyr.bat
│   └── lib .../etc
</code></pre></div><p>In a terminal, CD into <code>zephyr-main</code> (the parent of <code>bin</code>) and start the zephyr server
via <code>./bin/zephyr-home -h ./zephyr-home -s -c 2 &amp;</code></p> <p>where:</p> <ol><li><code>-h</code> specifies the ZEPHYR_HOME directory (defaults to <code>$HOME/.zephyr</code>)</li> <li><code>-s</code> start the server</li> <li><code>-c</code> the number of threads to allocate to the kernel.  Defaults to 2</li></ol> <p>This will start the server in the background.  You may trace its logs by locating the <code>logs</code> directory
and tailing the latest logs (you'll see something like:)</p> <div class="language- extra-class"><pre class="language-text"><code>$ tail -f zephyr.log
12/11/2021 12:36:30.799 - [io.zephyr.kernel.launch.KernelLauncher.scheduleTasks] - [INFO:main] - Scheduling Entry Point io.zephyr.logging.LogEntryPoint@157696f...
12/11/2021 12:36:30.815 - [io.zephyr.kernel.launch.KernelLauncher.scheduleTasks] - [INFO:main] - Successfully scheduled Entry Point io.zephyr.logging.LogEntryPoint@157696f
12/11/2021 12:36:30.815 - [io.zephyr.kernel.launch.KernelLauncher.scheduleTasks] - [INFO:main] - Scheduling Entry Point io.zephyr.banner.Banner@7ed70f...
12/11/2021 12:36:30.815 - [io.zephyr.kernel.launch.KernelLauncher.scheduleTasks] - [INFO:main] - Successfully scheduled Entry Point io.zephyr.banner.Banner@7ed70f
12/11/2021 12:36:30.815 - [io.zephyr.kernel.launch.KernelLauncher.scheduleTasks] - [INFO:main] - Scheduling Entry Point io.zephyr.kernel.launch.KernelLauncher@9d10bd...
12/11/2021 12:36:30.815 - [io.zephyr.kernel.launch.KernelLauncher.scheduleTasks] - [INFO:main] - Successfully scheduled Entry Point io.zephyr.kernel.launch.KernelLauncher@9d10bd
12/11/2021 12:36:30.815 - [io.zephyr.kernel.launch.KernelLauncher.scheduleTasks] - [INFO:main] - Scheduling Entry Point io.zephyr.kernel.modules.shell.ZephyrCliEntryPoint@1479c6...
12/11/2021 12:36:30.815 - [io.zephyr.kernel.launch.KernelLauncher.scheduleTasks] - [INFO:main] - Successfully scheduled Entry Point io.zephyr.kernel.modules.shell.ZephyrCliEntryPoint@1479c6
12/11/2021 12:36:30.831 - [io.zephyr.kernel.launch.KernelLauncher.runAll] - [WARNING:main] - Entry Point java.util.concurrent.FutureTask@67f029[Completed normally] has successfully exited
12/11/2021 12:36:30.831 - [io.zephyr.kernel.launch.KernelLauncher.runAll] - [WARNING:main] - Entry Point java.util.concurrent.FutureTask@1a20f67[Completed normally] has successfully exited
</code></pre></div><h3 id="start-the-zephyr-client"><a href="#start-the-zephyr-client" class="header-anchor">#</a> Start the Zephyr Client</h3> <p>In the same terminal, execute <code>./bin/zephyr -i</code>
where <code>-i</code> stands for <code>interactive</code>.  Zephyr will display its banner.</p> <div class="language- extra-class"><pre class="language-text"><code>$ ./bin/zephyr -i
Nov 12, 2021 12:36:30 PM io.zephyr.kernel.launch.KernelLauncher doLaunch
INFO: Zephyr Kernel Initiated...
Nov 12, 2021 12:36:30 PM io.zephyr.kernel.launch.KernelLauncher initialize
INFO: Initializing Entry Point io.zephyr.logging.LogEntryPoint@157696f...
Welcome to
======================================
 _____              __
/__  /  ___  ____  / /_  __  _______
  / /  / _ \/ __ \/ __ \/ / / / ___/
 / /__/  __/ /_/ / / / / /_/ / /
/____/\___/ .___/_/ /_/\__, /_/
         /_/          /____/

======================================
ZephyrCore :: Kernel Version 2.8.5.Final:: Revision &lt;&gt;
Build: &lt;&gt;
</code></pre></div><p>Start the Kernel by running <code>kernel start</code></p> <p>You'll see:</p> <div class="language- extra-class"><pre class="language-text"><code>
kernel start
Kernel is not running
Starting Zephyr Kernel
Successfully started Zephyr Kernel
Failed to restore kernel state.  Reason:
Modules installed:
</code></pre></div><p>Don't worry about the warnings--they're informational.</p> <h3 id="install-your-plugin"><a href="#install-your-plugin" class="header-anchor">#</a> Install your plugin!</h3> <p>Locate your <code>hello-world.war</code> under <code>zephyr-tutorials/lessons/1/hello-world/build/libs</code> and
grab its absolute path via <code>realpath hello-world.war</code>.  Then, returning to your Zephyr terminal,
run <code>plugin install &lt;path&gt;</code>.</p> <p>For instance, mine is at <code>C:/Users/josiah/dev/source/github.com/zephyr-tutorials/lessons/1/hello-world/build/libs/hello-world.war</code></p> <p>This should result in the following output:</p> <div class="language- extra-class"><pre class="language-text"><code>Will install:
 C:/Users/josiah/dev/source/github.com/zephyr-tutorials/lessons/1/hello-world/build/libs/hello-world.war
Successfully scheduled plugin installation set
Beginning download of plugin at 'Module{io.zephyr.tutorials:hello-world:1.0.0-SNAPSHOT}'
successfully installed plugins
Successfully installed plugin 'io.zephyr.tutorials:hello-world:1.0.0-SNAPSHOT'
successfully installed plugins
</code></pre></div><h4 id="familiarize-yourself-with-the-zephyr-cli"><a href="#familiarize-yourself-with-the-zephyr-cli" class="header-anchor">#</a> Familiarize yourself with the Zephyr CLI</h4> <p><strong>plugin list</strong></p> <p>In your zephyr terminal, run <code>plugin list</code>.  You should see:</p> <div class="language- extra-class"><pre class="language-text"><code>Modules installed:
 io.zephyr.tutorials:hello-world:1.0.0-SNAPSHOT | state Resolved
</code></pre></div><p><strong>plugin start</strong>
In your terminal, execute
<code>plugin start</code>io.zephyr.tutorials:hello-world:1.0.0-SNAPSHOT`</p> <p>You will see:</p> <div class="language- extra-class"><pre class="language-text"><code>Hello from io.zephyr.tutorials:hello-world:1.0.0-SNAPSHOT
</code></pre></div><p>output to the terminal</p> <p><strong>plugin stop</strong>
In your terminal, execute:
<code>plugin stop io.zephyr.tutorials:hello-world:1.0.0-SNAPSHOT</code>
You will see:</p> <div class="language- extra-class"><pre class="language-text"><code>Goodbye from io.zephyr.tutorials:hello-world:1.0.0-SNAPSHOT
</code></pre></div><p><strong>Note on State</strong>
Zephyr automatically saves and restores plugin state upon restarts.  Plugins that are inactive upon
stopping the kernel will remain inactive when it starts.  Plugins that are active upon stopping
the kernel will be activated when the kernel starts.</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/getting-started/getting-started.html" class="prev">
        Prerequisites
      </a></span> <span class="next"><a href="/getting-started/building-zephyr.html">
        Building Zephyr
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.735f26e0.js" defer></script><script src="/assets/js/2.c0ff3308.js" defer></script><script src="/assets/js/18.d1c8d034.js" defer></script>
  </body>
</html>
